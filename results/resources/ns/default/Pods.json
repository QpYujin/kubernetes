[{"metadata":{"name":"kube-consul-register-r90g7","generateName":"kube-consul-register-","namespace":"default","selfLink":"/api/v1/namespaces/default/pods/kube-consul-register-r90g7","uid":"d35cdce1-7dde-11e7-bf00-0ea50f7b4c40","resourceVersion":"1092","creationTimestamp":"2017-08-10T15:16:04Z","labels":{"app":"kube-consul-register"},"annotations":{"kubernetes.io/created-by":"{\"kind\":\"SerializedReference\",\"apiVersion\":\"v1\",\"reference\":{\"kind\":\"ReplicaSet\",\"namespace\":\"default\",\"name\":\"kube-consul-register\",\"uid\":\"d35c6536-7dde-11e7-bf00-0ea50f7b4c40\",\"apiVersion\":\"extensions\",\"resourceVersion\":\"1076\"}}\n"},"ownerReferences":[{"apiVersion":"extensions/v1beta1","kind":"ReplicaSet","name":"kube-consul-register","uid":"d35c6536-7dde-11e7-bf00-0ea50f7b4c40","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"default-token-k9233","secret":{"secretName":"default-token-k9233","defaultMode":420}}],"containers":[{"name":"kube-consul-register","image":"tczekajlo/kube-consul-register:0.1.4","args":["-logtostderr=true","-configmap=default/kube-consul-register"],"resources":{"requests":{"cpu":"1","memory":"300Mi"}},"volumeMounts":[{"name":"default-token-k9233","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"ip-172-20-51-64.ec2.internal","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.alpha.kubernetes.io/notReady","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.alpha.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}]},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2017-08-10T15:16:04Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2017-08-10T15:16:06Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2017-08-10T15:16:04Z"}],"hostIP":"172.20.51.64","podIP":"100.96.2.5","startTime":"2017-08-10T15:16:04Z","containerStatuses":[{"name":"kube-consul-register","state":{"running":{"startedAt":"2017-08-10T15:16:05Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"tczekajlo/kube-consul-register:0.1.4","imageID":"docker-pullable://tczekajlo/kube-consul-register@sha256:abc36b24f666155834f53b1603fde3c38bc91a7720134b9e3843d757f0ff224a","containerID":"docker://ae7e987c17a2440353d52959eed8600d688417d46e28781be5357b2ccd07cd24"}],"qosClass":"Burstable"}},{"metadata":{"name":"my-consul-consul-0","generateName":"my-consul-consul-","namespace":"default","selfLink":"/api/v1/namespaces/default/pods/my-consul-consul-0","uid":"ce1ce87b-7dde-11e7-bf00-0ea50f7b4c40","resourceVersion":"1162","creationTimestamp":"2017-08-10T15:15:55Z","labels":{"chart":"consul-0.3.0","component":"my-consul-consul","heritage":"Tiller","release":"my-consul"},"annotations":{"kubernetes.io/created-by":"{\"kind\":\"SerializedReference\",\"apiVersion\":\"v1\",\"reference\":{\"kind\":\"StatefulSet\",\"namespace\":\"default\",\"name\":\"my-consul-consul\",\"uid\":\"ce199afc-7dde-11e7-bf00-0ea50f7b4c40\",\"apiVersion\":\"apps\",\"resourceVersion\":\"1041\"}}\n","pod.alpha.kubernetes.io/initialized":"true","pod.beta.kubernetes.io/hostname":"my-consul-consul-0","pod.beta.kubernetes.io/subdomain":"my-consul-consul"},"ownerReferences":[{"apiVersion":"apps/v1beta1","kind":"StatefulSet","name":"my-consul-consul","uid":"ce199afc-7dde-11e7-bf00-0ea50f7b4c40","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"datadir","persistentVolumeClaim":{"claimName":"datadir-my-consul-consul-0"}},{"name":"gossip-key","secret":{"secretName":"my-consul-consul-gossip-key","defaultMode":420}},{"name":"default-token-k9233","secret":{"secretName":"default-token-k9233","defaultMode":420}}],"containers":[{"name":"my-consul-consul","image":"consul:0.8.3","command":["/bin/sh","-ec","IP=$(hostname -i)\n\nif [ -e /etc/consul/secrets/gossip-key ]; then\n  echo \"{\\\"encrypt\\\": \\\"$(base64 /etc/consul/secrets/gossip-key)\\\"}\" \u003e /etc/consul/encrypt.json\n  GOSSIP_KEY=\"-config-file /etc/consul/encrypt.json\"\nfi\n\nfor i in $(seq 0 $((${INITIAL_CLUSTER_SIZE} - 1))); do\n    while true; do\n        echo \"Waiting for ${STATEFULSET_NAME}-${i}.${STATEFULSET_NAME} to come up\"\n        ping -W 1 -c 1 ${STATEFULSET_NAME}-${i}.${STATEFULSET_NAME}.${STATEFULSET_NAMESPACE}.svc \u003e /dev/null \u0026\u0026 break\n        sleep 1s\n    done\ndone\n\nPEERS=\"\"\nfor i in $(seq 0 $((${INITIAL_CLUSTER_SIZE} - 1))); do\n    PEERS=\"${PEERS}${PEERS:+ } -retry-join $(ping -c 1 ${STATEFULSET_NAME}-${i}.${STATEFULSET_NAME}.${STATEFULSET_NAMESPACE}.svc | awk -F'[()]' '/PING/{print $2}')\"\ndone\n\nexec /bin/consul agent \\\n  -ui \\\n  -disable-host-node-id \\\n  -data-dir=/var/lib/consul \\\n  -server \\\n  -bootstrap-expect=${INITIAL_CLUSTER_SIZE} \\\n  -bind=0.0.0.0 \\\n  -advertise=${IP} \\\n  ${PEERS} \\\n  ${GOSSIP_KEY} \\\n  -client=0.0.0.0\n"],"ports":[{"name":"http","containerPort":8500,"protocol":"TCP"},{"name":"rpc","containerPort":8400,"protocol":"TCP"},{"name":"serflan-tcp","containerPort":8301,"protocol":"TCP"},{"name":"serflan-udp","containerPort":8301,"protocol":"UDP"},{"name":"serfwan-tcp","containerPort":8302,"protocol":"TCP"},{"name":"serfwan-udp","containerPort":8302,"protocol":"UDP"},{"name":"server","containerPort":8300,"protocol":"TCP"},{"name":"consuldns","containerPort":8600,"protocol":"TCP"}],"env":[{"name":"INITIAL_CLUSTER_SIZE","value":"1"},{"name":"STATEFULSET_NAME","value":"my-consul-consul"},{"name":"POD_IP","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"status.podIP"}}},{"name":"STATEFULSET_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}}],"resources":{"requests":{"cpu":"100m","memory":"256Mi"}},"volumeMounts":[{"name":"datadir","mountPath":"/var/lib/consul"},{"name":"gossip-key","readOnly":true,"mountPath":"/etc/consul/secrets"},{"name":"default-token-k9233","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"livenessProbe":{"exec":{"command":["consul","members"]},"initialDelaySeconds":300,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"ip-172-20-54-156.ec2.internal","securityContext":{"fsGroup":1000},"schedulerName":"default-scheduler","tolerations":[{"key":"node.alpha.kubernetes.io/notReady","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.alpha.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}]},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2017-08-10T15:15:56Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2017-08-10T15:16:29Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2017-08-10T15:15:56Z"}],"hostIP":"172.20.54.156","podIP":"100.96.1.7","startTime":"2017-08-10T15:15:56Z","containerStatuses":[{"name":"my-consul-consul","state":{"running":{"startedAt":"2017-08-10T15:16:29Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"consul:0.8.3","imageID":"docker-pullable://consul@sha256:008f9751b9e3282c2cd68462847c1eb77c5eae34fc17015ac62adeef3d127038","containerID":"docker://38cb2b8212aa7874ee69f7223d74d173ada8bf77f46c3d6a24edbb84bb79d466"}],"qosClass":"Burstable"}}]